{% extends "ideas/base.html" %}

{% block title %}Eureka - {{idea.title}}{% endblock %}

{% block navbar-links %}

<ul class="nav navbar-nav">
  {% if user.is_authenticated %}
  <li><a href="{% url 'ideas' %}">IDEAS</a></li>
  <li><a href="#">USERS</a></li>
  {% endif %}
</ul>

{% endblock %}

{% block content %}

{% load humanize %}
{% load gravatar %}

<!-- <div class="sub-navbar">
  <div class="container">
    <img class="pull-left" src="{% gravatar_url idea.user.email 40 %}" alt="">
    <h4 class="pull-left lead">{{ idea.title }} by <a href="#">{{ idea.user.username}}</a></h4>
  </div>
</div> -->


<script>

function confirmDel()
{
  
    $.post( "/", { data: "de", csrfmiddlewaretoken:'{{ csrf_token }}' })
    .done(function( data ) {
    alert( "Data Loaded: " + data );
    });

}

</script>

<!-- Modal -->
<div class="modal fade" id="delModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3 class="modal-title" id="myModalLabel">Deleting</h3>
      </div>
      <div class="modal-body">
        <div class="divDialogElements">
            <p>Are you shure you want to delete this idea?</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" onclick="confirmDel()">Confirm</button>{% csrf_token %}
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div class="idea idea-details">
                <div class="media">
                  <a class="pull-left" href="#">
                    <img class="media-object" src="{% gravatar_url idea.user.email 48%}" alt="...">
                </a>
                    <div class="btn-group pull-right">
                        <button class="btn btn-default" data-toggle="modal" data-target="#changeModal">
                            <span class="glyphicon glyphicon-cog"></span>
                        </button>
                        <button class="btn btn-default" data-toggle="modal" data-target="#delModal">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </div>
                <div class="media-body">
                    <h4 class="media-heading lead"><a href="#">{{idea.user.username}}</a></h4>
                    <h4 class="lead"><a href="{% url 'idea' idea_id=idea.id %}">{{idea.title}}</a></h4>
                    <p>{{idea.text}}</p>

                    {% if idea.interest_set.count > 0 %}
                    <div class="interested">
                      <p class="lead">Interested in this idea</p>
                      {% for interested in idea.interest_set.all|slice:":6" %}
                      <a href="#"><img src="{% gravatar_url interested.user.email 24 %}" title="{{interested.user.username}}"></a>
                      {% endfor %}
                      {% if idea.interest_set.all|length > 6 %}
                      <span>and {{ idea.interest_set.all|length|add:"-1"}} more</span>
                      {% endif %}
                  </div>
                  {% endif %}

                  <div class="idea-stats pull-right">
                      {% if idea.state == "I"%}
                      <span class="label label-warning">idle</span>
                      {% elif idea.state == "A" %}
                      <span class="label label-success">approved</span>
                      {% else %}
                      <span class="label label-danger">rejected</span>
                      {% endif %}
                      <span class="label label-default">0 likes</span>
                      <!-- <span class="label label-default">4 users interested</span> -->
                  </div>
                  <span class="pull-left">{{idea.created|naturaltime}}</span>
              </div> <!-- /mediabody -->
          </div> <!-- /media -->
      </div>


            <!-- <div class="comments">
                <h4 class="lead">0 Comments</h4>
                <hr>
            </div> -->
        </div>

        <div class="col-md-4">

        </div>
    </div>

</div><!-- /.container -->
{% endblock %}
